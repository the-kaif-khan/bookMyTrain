<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>blogging web practice</title>

  <link rel="stylesheet" href="/stylesheets/homePagesCSS/profile-page.css">
  <link rel="stylesheet" href="/stylesheets/homePagesCSS/selling-product.css">
  <link rel="stylesheet" href="/stylesheets/sellingPagesCSS/landbooker-selling-form-page-products.css">
  <link rel="stylesheet" href="/stylesheets/homePagesCSS/main-home-footer-page.css">
  <link rel="stylesheet" href="/stylesheets/homePagesCSS/profileClaimCartCss.css">
  <link rel="stylesheet" href="/stylesheets/buyingCartPagesCSS/buying-now-at-profile.css">

      <!-- google translate hidden element (head) -->
<div id="google_translate_element" style="display:none;"></div>

<script>
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'en',
      includedLanguages: 'en,hi,bn,ur,ta,te,pa,gu,ml,mr,it',
      autoDisplay: false,
    }, 'google_translate_element');
  }
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</head>
<body>

  <div class="header">
    <div class="title">
      Landbook
    </div>
    <div class="aboutPage">
      Welcome, <%= user.name %> to your profile page.
    </div>
    <!-- <div class="messageContainer">
      <a href="/home/landbook" class="homeIconLink">
        <div class="homeIcon">
          Home
        </div>
      </a>
      <a href="/us/user/message/<%= user._id %>" class="messageIconLink" title="Message from Landbook">
        <div class="messageIcon">
          Message
        </div>
      </a>
      <div class="messageIconTooltip">
        <%= user.buyingMessageFromLandbook.filter(m => !m.read).length + user.sellingMessageFromLandbook.filter(m => !m.read).length + user.claimedMessageFromLandbook.filter(m => !m.read).length%> New
      </div>
    </div> -->

    <!-- navigations -->
    <div class="navigationsBox">
      <a href="/home/landbook" class="links">
        <div class="navLinks">
          Home
        </div>       
      </a>

      <a href="/us/user/message/<%= user._id %>" class="links">
        <div class="navLinks messageButton">
          Message
        </div>
        <div class="messageNotification">
          <%= user.buyingMessageFromLandbook.filter(m => !m.read).length + user.sellingMessageFromLandbook.filter(m => !m.read).length + user.claimedMessageFromLandbook.filter(m => !m.read).length%> New
        </div>
      </a>
    </div>
  </div>

  <div class="profileWholeContainer">

    <div class="aboutMainProfile">
      <a href="" class="links" title="Change profile picture">
        <div class="profileImage">
          <img src="/imagesAndVideos/images/yeah.jpg" alt="">
        </div>
      </a>
      <div class="nameAndEmail">
        <div class="userName">
          <%= user.name %>
        </div>
        <div class="userEmail">
          <%= user.username %>
        </div>
      </div>
      <div class="totalPosts">
        <div class="postsNumber">
          <%= user.buyingCart.length %>
        </div>
        <div class="postsText">
          Buying products
        </div>
      </div>
      <div class="profilePostsLikes">
        <div class="likesNumber">
          <%= user.sellingProduct.length %>
        </div>
        <div class="likesText">
          Selling products
        </div>
      </div>
    </div>
    
    <a href="/us/user-buying-cart-timers" class="links">
      <div class="buyingCartTimersAlert <%= user.buyingCartTimerId.length > 0 ? 'blink-red-white' : 'hidden' %>">
        Buying cart timers
      </div>
    </a>


    <% if(success.length > 0) { %>
      <div class="flash flash-success">
        <%= success %>
      </div>
    <% } %>
    <% if(error.length > 0) { %>
      <div class="flash flash-error">
        <%= error %>
      </div>
    <% } %>

    <!-- <div class="blogging">
      <input type="text" placeholder="What's in your mind?" class="inputText" required>
      <input type="submit" value="Create Post" class="createButton">
    </div> -->

    <div class="blogContents">
      
      <!-- buying forms of user -->
      <div class="toggle-button" onclick="toggleView('buyingForm')">
        Buying forms timer for buying 
        <span class="noProducts">
          <% if(buyingForms.length > 0) { %>
            <span class="highlights"><%= buyingForms.length %></span> buying form
          <% } else { %>
            no buying forms
          <% } %>
        </span>
      </div>
      <div id="buyingForm" class="post-section">
        <% if(buyingForms) { %>
          <% buyingForms.forEach((buyingForm) => { %>
            <div class = "productsContainer post-card">
                <div id = "<%= buyingForm._id %>">
                  <!-- <div class="productsImage">
                    <img src= "" alt="Timing to add product here">
                  </div> -->
  
                  <!-- timer placeholder -->
                  
                  <div class="timer-container">
                    <div class="timer" data-createdat="<%= buyingForm.createdAt %>" data-formid="<%= buyingForm._id %>">
                      Loading...
                    </div>
                    <div class="progress-bar">
                      <div class="progress"></div>
                    </div>
                  </div>
  
                  <div class="productsPriceAndLB">
                    <div class= "productsPrice">
                      Buyer: <%= buyingForm.name %>
                    </div>
                    <div class= "productsLB">
                      Contact number: <%= buyingForm.contactNumber %>
                    </div>
                  </div>
                  <div class="productsSpec">
                    Address of buyer: <%= buyingForm.address %>
                  </div>
                  <div class="productsStats">
                    <div class="productsVisit">

                    </div>
                    <div class="productsRating">
                      <img src= "">
                    </div>
                    <!-- <div class="productsDetail">
                      Buying Product id: <%= buyingForm.product %> &#183
                    </div> -->
                    <div class="productsDetail">
                      <b>Note:</b> This buying form will be automatically removed in 5 hours to when this buying form was created and the product of this buying form will be added to your buying cart...and then this zameen will proceeds to fast pace buying until then, you have to wait 5 hours. This 5 hours is given to the claimed people of this zameen and if they able to give bayana to this zameen before this 5 hours...This zameen can be theirs but only if they able to give bayana to this zameen before 5 hours. If they take 5 hours + 1 minute to give bayana, then also, they will not be able to buy this zameen and their bayana will be quashed(khariz). And also if you not be able to give bayana in less than 46 hours to the moment of adding this zameen to fast pace buying for you, then all your convenience in buying this zameen will be removed and if you wanna this zameen, you'll have start all over again with Landbook.
                    </div>
                  </div>
                  <a href="/us/user/delete-buying-form/<%= buyingForm._id %>" class="deleteLink" onclick="return confirmDelete();">
                    <button type="submit" class="claimToCartButton">
                      Delete buying form
                    </button>
                  </a>

                </div>
              
            </div>
          <% }) %>
        <% } else{ %>
          <div class="noProducts">No buying forms</div>
        <% } %>
      </div>

      <!-- claim cart products -->
      <div class="toggle-button" onclick="toggleView('s')">
        All claim cart products
      </div>
      <div id="s" class="CCPost-section">

        <!-- <div class="claimCartPost-section"> -->
          <!-- cart products in this div -->
          <div class="cartProductsContainer">
            <% if(claimProducts.length > 0) { %>
              <% claimProducts.forEach((product) => { %>
                <div id="<%= product._id %>" class="post-card">
                  <div class="products">
                    <div class="leftContainer">
                      <div class="leftContainerHeading">
                        <b>If bought now:</b> Expected date when zameen 
                        will be bought: 24-02-2023
                      </div>
                      <div class="productImage">
                        <img src="data:image/jpeg;base64, <%= product.productImages[0].toString('base64') %>" alt="">
                      </div>
                      <div class="productPriceAndLB">
                        <div class= "productPrice">
                          Price: <%= product.landbookPrice %> Lakhs
                        </div>
                        <div class= "productLB">
                          L*B: <%= product.LB %>
                        </div>
                      </div>
                      <div class="productSpec">
                        <%= product.spec %>
                      </div>
                      <div class="buyNow">
                        <a href="/buy/buyingForm/<%= product._id %>/<%= product.city %>/<%= product.tehsil %>" class="buyNowLink">
                        <button class="buyNowButton js-buy-now">
                          Buy Now Within 48 Hours.
                        </button>
                        </a>
                      </div>
                    </div>
                    <div class="rightContainer">
                      <div class="rightContainerHeading">
                        Your Claimed product stats by now:
                      </div>
                      <div class="newClaimed">
                        People claimed: <b> + <%= product.claimedPeople.length %></b>
                      </div>
                      <div class="newViews">
                        People viewed: <b> + <%= product.visits.length %></b>
                      </div>
                      
                      <% if(claimCartBuyingForm) { %>
                        <div class="timerTitle">
                          Time left for claimed people to give Bayana to this land
                        </div>
                        <div class="timer-container">
                          <div class="claimTimer" data-createdat="<%= claimCartBuyingForm.createdAt %>" data-claimformid="<%= claimCartBuyingForm._id %>">
                            Loading...
                          </div>
                          <div class="progress-bar">
                            <div class="claimProgress"></div>
                          </div>
                        </div>
                      <% } %>

                      <div class="redAlert <%= product.buyingForm.length > 0 ? 'blink-red-white' : '' %>">
                        Buying by other notice
                      </div>
                      <a href="/buy/give-bayana/<%= product.city %>/<%= product.tehsil %>/<%= product._id %>" class="link">
                        <div class="bayanaBox">
                          Click to give bayana to this zameen.
                        </div>
                      </a>
                      <a href="/buy/remove/claimcart/<%= product._id %>" class="removeProduct">
                        <div class= "removeProduct js-remove-product">
                          Remove product
                        </div>
                      </a>
                    </div> 
                  </div> 
                </div>
            
              <% }) %>
            <%} else { %>
              <div class="noProducts">
                There is no products claimed by you
              </div>
            <% } %>
      
          </div>
          <!-- cart products in this upper div -->

          <!-- buying summary -->
          <% 
          let sellerPrice = 0;
          <!-- let landbookPrice = 0; -->
          claimProducts.forEach((claimProduct) => {
            sellerPrice += claimProduct.sellerPrice;
          });
          const likhwayiFemale = sellerPrice * 0.07;
          const likhwayiMale = sellerPrice * 0.08;
          const brokerCost = sellerPrice * 0.038;
          const landbookCost = sellerPrice * 0.023;
          const customerSaved = brokerCost - landbookCost;
          const finalMale = sellerPrice + likhwayiMale + landbookCost;
          const finalFemale = sellerPrice + likhwayiFemale + landbookCost;
          %>
      
          <!-- buying summary -->
          <% if(claimProducts.length > 0) { %>
            <div class="buyingSummary js-buying-summary">
              <div class="buyingSummaryHeading">
                Buying Summary
              </div>
              <div class="numberOfZameens">
                Zameens (<span class="js-cartItemNumber"><%= claimProducts.length %></span>)
              </div>
              <div class="buyingSummaryContentsContainer">
                <div class="buyingSummaryContents">
                  <div class="landbookTitle">
                    Landbook Price
                  </div>
                  <div class="titles">
                    Price:
                  </div>
                  <div class="numbers">
                    <b><%= sellerPrice.toFixed(2) %> Lakhs.</b>
                  </div>
                  <div class="titles">
                    Likhwayi [female(6%) / male(7%) + 1% regn.charges]
                  </div>
                  <div class="numbers">
                    <b><%= likhwayiFemale.toFixed(2) %> Lakhs</b>(female)
                  </div>
                  <div class="titles">
                    Likhwayi (Male)
                  </div>
                  <div class="numbers">
                    <b><%= likhwayiMale.toFixed(2) %> Lakhs</b>
                  </div>
                  <div class="titles">
                    <span class="logo">Landbook</span> <a href="" class="convenienceLinks">
                      convenience
                    </a> fee(1.5%)
                  </div>
                  <div class="landbookConvenience">
                    <b><%= landbookCost.toFixed(2) %> Lakhs</b>
                  </div>
                </div>
        
        
                <div class="buyingSummaryContents">
                  <div class="brokerTitle">
                    Broker Price
                  </div>
                  <div class="titles">
                    Price:
                  </div>
                  <div class="numbers">
                    <b><%= sellerPrice.toFixed(2) %> Lakhs.</b>
                  </div>
                  <div class="titles">
                    Likhwayi [female(6%) / male(7%) + 1% regn.charges]
                  </div>
                  <div class="numbers">
                    <b><%= likhwayiFemale.toFixed(2) %> Lakhs</b>(female)
                  </div>
                  <div class="titles">
                    Likhwayi (Male)
                  </div>
                  <div class="numbers">
                    <b><%= likhwayiMale.toFixed(2) %> Lakhs</b>
                  </div>
                  <div class="titles">
                    Broker convenience fee(3.8+%)
                  </div>
                  <div class="brokerConvenience">
                    <b><%= brokerCost.toFixed(2) %> Lakhs</b> <a href="" class="sourceLinks">source</a>
                  </div>
                </div>
        
                <div class="lastTitles">
                  You saved: (broker)-(landbook) convenience fee: 
                </div>
                <div class="numbers">
                  <b><%= customerSaved.toFixed(2) %> lakhs.</b>
                </div>
                <div class="landbookPriceTitle">
                  Total Price (Female):
                </div>
                <div class="landbookPrice">
                  <b><%= finalFemale.toFixed(2) %> lakhs.</b>
                </div>
                <div class="landbookPriceTitle">
                  Total Price (Male):
                </div>
                <div class="landbookPrice">
                  <b><%= finalMale.toFixed(2) %> lakhs.</b>
                </div>
        
              </div>
            </div>
          <% } %>

        <!-- </div> -->
        
      </div>

      <!-- buying cart products -->
      <div class="toggle-button" onclick="toggleView('most')">
        Buying cart products
      </div>
      <div id="most" class="CCPost-section">

        <div class="cartProductsContainer">
          <% if(buyingCartProducts.length > 0) { %>
            <% buyingCartProducts.forEach((buyingProduct) => { %>
              <div id="<%= buyingProduct._id %>" class="post-card">
                <div class="products">
                  <div class="leftContainer">
                    <div class="productImage">
                      <img src="/imagesAndVideos/images/2.jpg" alt="">
                    </div>
                    <div class="productPriceAndLB">
                      <div class= "productPrice">
                        Price: <%= buyingProduct.landbookPrice %> Lakhs
                      </div>
                      <div class= "productLB">
                        L*B: <%= buyingProduct.LB %>
                      </div>
                    </div>
                    <div class="productSpec">
                      <%= buyingProduct.spec %>
                    </div>
                    <a href="/buy/give-bayana/<%= buyingProduct._id %>" class="link">
                      <div class="remainingClaimingEndTime">
                        <div class="remainingClaimingEndTime2">
                          Click here to give bayana
                        </div>
                      </div>
                    </a>
                  </div>
                  <div class="rightContainer">
                    <div class="rightContainerHeading">
                      After Buying Now by you:
                    </div>
                    <div class="newClaimed">
                      People claimed: <b> + <%= buyingProduct.claimedPeople.length %></b>
                    </div>
                    <div class="newViews">
                      People viewed: <b> + <%= buyingProduct.visits.length %></b>
                    </div>
                    <a href="/us/user-buying-cart-timers" class="links">
                      <div class="buyingCartTimersAlert <%= user.buyingCartTimerId.length > 0 ? 'blink-red-white' : 'hidden' %>">
                        Buying cart timers
                      </div>
                    </a>
                    <div class="redMessage">
                      No claimed user able to give bayana to this land. Now you (Buying user) have 72 hours (3 days) to give bayana to this land otherwise this land will be removed automatically from your Buying Cart then you will not be able to give bayana or buy this land unless in order to buy this land again, user have to go through whole buying process all over again e.g from giving the claimed user's 6 hours to rest of the processes.
                    </div>
                    <div class="bayanaBox">
                      Click Blinking Buying cart timers to view how much time left for you out of 72 hours to give bayana to this product now... 
                    </div>
                    <a href="/buy/remove/buyingcart/<%= buyingProduct._id %>" class="removeProduct">
                      <div class= "removeProduct js-remove-product">
                        Remove Product
                      </div>
                    </a>
                  </div> 
                </div> 
              </div>
            <% }) %>
          <% } else { %>
            <div class="noProducts">
              No buying products yet.
            </div>
          <% } %>
        </div>


        <!-- buying summary -->
        <% 
          let buyingOriginalPrice = 0;
          <!-- let landbookPrice = 0; -->
          buyingCartProducts.forEach((buyingProduct) => {
            buyingOriginalPrice += buyingProduct.sellerPrice;
          });
          const buyingLikhwayiFemale = buyingOriginalPrice * 0.07;
          const buyingLikhwayiMale = buyingOriginalPrice * 0.08;
          const buyingBrokerCost = buyingOriginalPrice * 0.038;
          const buyingLandbookCost = buyingOriginalPrice * 0.023;
          const buyingCustomerSaved = buyingBrokerCost - buyingLandbookCost;
          const buyingFinalMale = buyingOriginalPrice + buyingLikhwayiMale + buyingLandbookCost;
          const buyingFinalFemale = buyingOriginalPrice + buyingLikhwayiFemale + buyingLandbookCost;
        %>

        <!-- buying summary -->
        <div class="<%= user.buyingCartTimerId.length > 0 ? 'buyingSummary js-buying-summary' : 'hidden' %>">
          <div class="buyingSummaryHeading">
            Buying Summary
          </div>
          <div class="numberOfZameens">
            Zameens (<span class="js-cartItemNumber"><%= buyingCartProducts.length %></span>)
          </div>
          <div class="buyingSummaryContentsContainer">
            <div class="buyingSummaryContents">
              <div class="landbookTitle">
                Landbook Price
              </div>
              <div class="titles">
                Price:
              </div>
              <div class="numbers">
                <b><%= buyingOriginalPrice.toFixed(2) %> Lakhs.</b>
              </div>
              <div class="titles">
                Likhwayi [female(6%) / male(7%) + 1% regn.charges]
              </div>
              <div class="numbers">
                <b><%= buyingLikhwayiFemale.toFixed(2) %> Lakhs</b>(female)
              </div>
              <div class="titles">
                Likhwayi (Male)
              </div>
              <div class="numbers">
                <b><%= buyingLikhwayiMale.toFixed(2) %> Lakhs</b>
              </div>
              <div class="titles">
                <span class="logo">Landbook</span> <a href="" class="convenienceLinks">
                  convenience
                </a> fee(0.8%)
              </div>
              <div class="landbookConvenience">
                <b><%= buyingLandbookCost.toFixed(2) %> Lakhs</b>
              </div>
            </div>


            <div class="buyingSummaryContents">
              <div class="brokerTitle">
                Broker Price
              </div>
              <div class="titles">
                Price:
              </div>
              <div class="numbers">
                <b><%= buyingOriginalPrice.toFixed(2) %> Lakhs.</b>
              </div>
              <div class="titles">
                Likhwayi [female(6%) / male(7%) + 1% regn.charges]
              </div>
              <div class="numbers">
                <b><%= buyingLikhwayiFemale.toFixed(2) %> Lakhs</b>(female)
              </div>
              <div class="titles">
                Likhwayi (Male)
              </div>
              <div class="numbers">
                <b><%= buyingLikhwayiMale.toFixed(2) %> Lakhs</b>
              </div>
              <div class="titles">
                Broker convenience fee(1.5+%)
              </div>
              <div class="brokerConvenience">
                <b><%= buyingBrokerCost.toFixed(2) %> Lakhs</b> <a href="" class="sourceLinks">source</a>
              </div>
            </div>

            <div class="lastTitles">
              You saved: (broker)-(landbook) convenience fee: 
            </div>
            <div class="numbers">
              <b><%= buyingCustomerSaved.toFixed(2) %> lakhs.</b>
            </div>
            <div class="landbookPriceTitle">
              Total Price (Female):
            </div>
            <div class="landbookPrice">
              <b><%= buyingFinalFemale.toFixed(2) %> lakhs.</b>
            </div>
            <div class="landbookPriceTitle">
              Total Price (Male):
            </div>
            <div class="landbookPrice">
              <b><%= buyingFinalMale.toFixed(2) %> lakhs.</b>
            </div>

          </div>
        </div>

      </div>

      <!-- selling products -->
      <div class="toggle-button" onclick="toggleView('least')">
        Selling products 
        <% if(userSellingForms.length > 0) { %>
          <span id="userSellingFormNumber">
            <%= userSellingForms.length %> pending...
          </span>
        <% } %> 
      </div>
      <div id="least" class="post-section mainSellingProductsContainer">

        <% if(user.sellingProduct.length > 0) { %>
          <% userSellingProducts.forEach((sellingProduct) => { %>
            <div class = "productsContainer post-card">
              <div id = "<%= sellingProduct._id %>">
                <a href="/buy/viewproduct/<%= sellingProduct._id %>/<%= sellingProduct.city %>/<%= sellingProduct.tehsil %>" class="sellingProductLink">
                  <div class="sellingProductsImage">
                    <img src= "/imagesAndVideos/images/2.jpg" alt="">
                  </div>
                  <div class="sellingProductsPriceAndLB">
                    <div class= "sellingProductsPrice">
                      Rs. <%= sellingProduct.landbookPrice.toFixed(2) %> Lakhs.
                    </div>
                    <div class= "sellingProductsLB">
                      L * B: <%= sellingProduct.LB %>
                    </div>
                  </div>
                  <div class="sellingProductsSpec">
                    <%= sellingProduct.spec %>
                  </div>
                  <div class="sellingProductsStats">
                    <div class="sellingProductsVisit">
                      Times Visited: <%= sellingProduct.visits %> &#183
                    </div>
                    <div class="sellingProductsRating">
                      <img src= "">
                    </div>
                    <div class="sellingProductsClaim">
                      Claim: <%= sellingProduct.claimedPeople.length %> &#183
                    </div>
                  </div>
                </a>
                <% if(sellingProduct.buyingForm.length > 0 || sellingProduct.buyingCartTimerId.length > 0) { %>
                  <div class="noteForSellingNotAvail">
                    Sorry, You cannot change your this product's selling price right now as it is now in buying process by someone. Try again later if someone not be able to buy the land.
                  </div>
                <% } else { %>
                  <div class="changeSellingPrice">
                    <a href="/us/user/changeSellingPrice/<%= sellingProduct._id %>" class="changeSellingPriceLink">
                      Change your selling price
                    </a>
                  </div>
                <% } %>
                <% if(sellingProduct.buyingForm.length > 0 || sellingProduct.buyingCartTimerId.length > 0) { %>
                  <div class="notAvailable">
                    Changing your selling price is unavailable as some user wants to buy your land.
                  </div>
                <% } else { %>
                  <div class="available">
                    Changing your selling price is available.
                  </div>
                <% } %>
                <div class="noteForSelling">
                  <b>Note:</b> In order to change the selling price of your product, user have to log in again and Before Landbook makes sure that no users is buying your land currently.
                </div>
                <!-- <a href="/buy/addtoclaim/basti/<%= sellingProduct._id %>" class="productLink">
                  <button class= "sellingProductClaimToCartButton"> 
                    Claim To Land Cart
                  </button>
                </a> -->
              </div>
            </div>
          <% }) %>
        <% } else { %>
          <div class="noProducts">
            There is no product that you are selling.
          </div>
        <% } %>

      </div>
      
    </div>

  </div>

  <footer>

    <div class="aboutThisPage">
      <div class="aboutThisPageLanguage">
        <div class="languageImage">
          üåê
        </div>
        <div class="languageText">
           English
        </div>  
      </div>

      <div class="aboutCountry">
        <div class="aboutCountryImage">
          <img src="/imagesAndVideos/images/1f1ee-1f1f3.png" alt="">
        </div>
        <div class="aboutCountryText">
           India
        </div>
      </div>
    </div>

    <div class="aboutCompany">
      <div class="companyConditions aboutCompanyTexts">
        Conditions of Use
      </div>
      <div class="companyPrivacyPolicy aboutCompanyTexts">
        Privacy Notice
      </div>
      <div class="aboutAdvertising aboutCompanyTexts">
        Interest-Based Ads
      </div>
    </div>

    <div class="companyCopywrite">
      .c. 1996-2024, Landbook.com, Inc. and its affiliates
    </div>

  </footer>

  <!-- <script src="../public/javascripts/profileTimers.js"></script> -->
  <script src="/javascripts/claimTimer.js"></script>

  <!-- <script>
    function confirmDelete() {
      return confirm('Are you sure you want to delete this buying form? This action cannot be undone!')
    }

    let openSection = null;
    function toggleView(id) {
      const section = document.getElementById(id);

      if(openSection && openSection !== section) {
        openSection.style.maxHeight = 0;
        openSection.classList.remove('open');
      }

      if(section.classList.contains('open')) {
        section.style.maxHeight = 0;
        section.classList.remove('open');
        openSection = null;
      } else {
        section.classList.add('open');
        section.style.maxHeight = section.scrollHeight + 'px';
        openSection = section;
      }
    }

    // for buying form timer at profile... scripts starts here
    const timers = document.querySelectorAll('.timer');
    timers.forEach(timer => {
      const createdAt = new Date(timer.dataset.createdat);
      const endTime = new Date(createdAt.getTime() + 4 * 60 * 1000);
      const formId = timer.dataset.formid;
      const progressBar = timer.nextElementSibling.querySelector('.progress');

      function updateTimer() {
        const now = new Date();
        const diff = endTime - now;
        const total = 4 * 60 * 1000;
        if(diff <= 0) {
          timer.textContent = 'Time Over';
          timer.classList.add('over');
          progressBar.style.width = '0%';
          // move automatically
          fetch(`/home/admin/move-buying-form/${formId}`, {
            method: 'POST'
          }).then(res => {
            if(res.ok) {
              console.log('Product moved to buying cart automatically!');
              location.reload();
            }
          });
        } else {
          const hours = Math.floor(diff / (1000 * 60 * 60));
          const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((diff % (1000 * 60)) / 1000);
          timer.textContent = `${hours}hr ${minutes}min ${seconds}sec`;
          // update progress bar
          const percentage = (diff / total) * 100;
          progressBar.style.width = `${percentage}`;
        }
      }
      setInterval(updateTimer, 1000);
      updateTimer();
    })
    
    // for claimTimer scripts at profile starts here
      const claimTimers = document.querySelectorAll('.claimTimer');
      claimTimers.forEach(timer => {
      const createdAt = new Date(timer.dataset.createdat);
      const endTime = new Date(createdAt.getTime() + 4 * 60 * 1000);
      const formId = timer.dataset.claimformid;
      const progressBar = timer.nextElementSibling.querySelector('.claimProgress');

      function updateTimer() {
        const now = new Date();
        const diff = endTime - now;
        const total = 4 * 60 * 1000;
        if(diff <= 0) {
          timer.textContent = 'Time Over';
          timer.classList.add('over');
          progressBar.style.width = '0%';
          // move automatically
          // fetch(`/home/admin/move-buying-form/${formId}`, {
          //   method: 'POST'
          // }).then(res => {
          //   if(res.ok) {
          //     console.log('Product moved to buying cart automatically!');
          //     location.reload();
          //   }
          // });
        } else {
          const hours = Math.floor(diff / (1000 * 60 * 60));
          const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((diff % (1000 * 60)) / 1000);
          timer.textContent = `${hours}hr ${minutes}min ${seconds}sec`;
          // update progress bar
          const percentage = (diff / total) * 100;
          progressBar.style.width = `${percentage}`;
        }
      }
      setInterval(updateTimer, 1000);
      updateTimer();
    })
    // for claimTimer script at profile ends here

  </script> -->


  <select id="languageSelect language-select" hidden>
    <option value="en">English</option>
    <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
    <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
    <option value="ur">ÿßÿ±ÿØŸà</option>
    <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
    <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
    <option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option>
    <option value="gu">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</option>
    <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</option>
    <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
    <option value="it">Italiano</option>
  </select>


  <script>
  (function() {
const SELECT_ID = 'languageSelect';
const STORAGE_KEY = 'preferredLanguage';
const defaultSourceLang = 'en';

function setCookie(name, value, days, path = '/') {
  const d = new Date();
  d.setTime(d.getTime() + (days*24*60*60*1000));
  document.cookie = `${name}=${value};expires=${d.toUTCString()};path=${path}`;
}

function getCookie(name) {
  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  return match ? decodeURIComponent(match[2]) : null;
}

// Extract target language from googtrans cookie ("/en/hi" ‚Üí "hi")
function currentLangFromCookie() {
  const c = getCookie('googtrans');
  if (!c) return defaultSourceLang;
  const parts = c.split('/');
  return parts[2] || defaultSourceLang;
}

function trySetComboLang(lang) {
  const combo = document.querySelector('.goog-te-combo');
  if (combo) {
    if (combo.value !== lang) {
      combo.value = lang;
      combo.dispatchEvent(new Event('change'));
      console.log('Translate combo switched ‚Üí', lang);
    } else {
      console.log('Language already active ‚Üí', lang);
    }
    return true;
  }
  return false;
}

function fallbackSetLang(lang) {
  try {
    setCookie('googtrans', `/${defaultSourceLang}/${lang}`, 365, '/');
    setCookie('googtrans', `/${defaultSourceLang}/${lang}`, 365, '/');
    window.location.reload();
  } catch (e) {
    console.error('fallbackSetLang error', e);
  }
}

function setLanguage(lang) {
  localStorage.setItem(STORAGE_KEY, lang);

  // prevent loop if already same language
  const current = currentLangFromCookie();
  if (current === lang) {
    console.log('Skip re-translate (already', lang, ')');
    return;
  }

  let attempts = 0;
  const maxAttempts = 25;
  const interval = setInterval(() => {
    attempts++;
    const done = trySetComboLang(lang);
    if (done) {
      clearInterval(interval);
      return;
    }
    if (attempts >= maxAttempts) {
      clearInterval(interval);
      console.warn('Combo not found, fallback to cookie');
      fallbackSetLang(lang);
    }
  }, 100);
}

function initSelector() {
  const sel = document.getElementById(SELECT_ID);
  if (!sel) return;

  // restore saved
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) {
    sel.value = saved;
    const current = currentLangFromCookie();
    if (current !== saved) {
      setLanguage(saved);
    }
  }

  sel.addEventListener('change', function() {
    const lang = this.value;
    setLanguage(lang);
  });
}

if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initSelector);
} else {
  initSelector();
}
})()

  </script>


</body>
</html>