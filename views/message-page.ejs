<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>message page</title>

  <link rel="stylesheet" href="/stylesheets/homePagesCSS/message-page.css">
  <link rel="stylesheet" href="/stylesheets/homePagesCSS/main-home-footer-page.css">

      <!-- google translate hidden element (head) -->
<div id="google_translate_element" style="display:none;"></div>

<script>
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'en',
      includedLanguages: 'en,hi,bn,ur,ta,te,pa,gu,ml,mr,it',
      autoDisplay: false,
    }, 'google_translate_element');
  }
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</head>
<body>
  
  <div class="header">
    <div class="title">
      Landbook
    </div>
    <div class="aboutPage">
      Message from landbook
    </div>
  </div>
  <!-- navigations -->
  <div class="navigationsBox">
    <a href="/home/landbook" class="links">
      <div class="navLinks">
        Home
      </div>       
    </a>

    <a href="/us/user/profile" class="links">
      <div class="navLinks">
        Go to profile
      </div>
    </a>
  </div>


  <div class="">
    <div class="aboutContainer">
      <div class="aboutContainerTexts">
        This is the message from <span class="logo">Landbook</span>... eg. When Landbook wants to send user to some information or what product they claimed and some details about it.. and also some errors eg. if user give wrong contact numbers in selling forms or buying forms... then <span class="logo">Landbook</span> will send message to them and, they will appear here.
      </div>
    </div>

    <!-- for buying messages -->
    <div class="toggle-button" onclick="toggleView('buyingMessageFromLandbook')">
      Buying form messages 
      <% if(user.buyingMessageFromLandbook.length > 0) { %>
        <span class="blue-dot"></span>
      <% } %>
    </div>
    <div id="buyingMessageFromLandbook" class="post-section">
      <% if(user.buyingMessageFromLandbook.length > 0) { %>
        <% user.buyingMessageFromLandbook.reverse().forEach((buyingMessage) => { %>
          <div class="message post-card">

            <div class="user">
              <div class="contactNumberOfUser">
                Date when you filled that buying form: <%= buyingMessage.buyingFormDate.toLocaleString(); %>
              </div>
            </div>

            <%= buyingMessage.message %>
            
          </div>
          <span class="date"><%= buyingMessage.date.toLocaleString(); %></span>
        <% }) %>
      <% } else { %>
        <div class="post-card">
          No buying messages yet.
        </div>
      <% } %>
    </div>

    <!-- for selling messages -->
    <div class="toggle-button" onclick="toggleView('sellingMessageFromLandbook')">
      Selling form messages
      <% if(user.sellingMessageFromLandbook.length > 0) { %>
        <span class="blue-dot"></span>
      <% } %>
    </div>
    <div id="sellingMessageFromLandbook" class="post-section">
      <% if(user.sellingMessageFromLandbook.length > 0) { %>
        <% user.sellingMessageFromLandbook.reverse().forEach((sellingMessage) => { %>
          <div class="message post-card">

            <div class="user">
              <div class="contactNumberOfUser">
                Date when you filled that selling form: <%= sellingMessage.sellingFormDate.toLocaleString(); %>
              </div>
            </div>

            <%= sellingMessage.message %>

          </div>
          <span class="date"><%= sellingMessage.date.toLocaleString(); %></span>
        <% }) %>
      <% } else { %>
        <div class="post-card">
          No selling messages yet.
        </div>
      <% } %>
    </div>

    <!-- for claimed product messages -->
    <div class="toggle-button" onclick="toggleView('claimedMessageFromLandbook')">
      Claimed product messages
      <% if(user.claimedMessageFromLandbook.length > 0) { %>
        <span class="blue-dot" id="claimedDot"></span>
      <% } %>
    </div>
    <div id="claimedMessageFromLandbook" class="post-section">
      <% if (user.claimedMessageFromLandbook.length > 0) { %>
        <% user.claimedMessageFromLandbook.reverse().forEach(claimedMsg => { %>
          <div class="post-card">
            <div class="message post-card">
              <% if (claimedMsg.productDetails && claimedMsg.productDetails.length > 0) { %>
                <% claimedMsg.productDetails.forEach(product => { %>
                  <div class="user">
                    <div class="nameOfUser">
                      Number of land: <%= product.zameenNumber %>
                    </div>
                    <div class="usernameOfUser">
                      Price: <%= product.landbookPrice %>
                    </div>
                    <div class="usernameOfUser">
                      L*B: <%= product.LB %>
                    </div>
                    <div class="emailOfUser">
                      City: <%= product.city %>
                    </div>
                    <div class="contactNumberOfUser">
                      Tehsil: <%= product.tehsil %>
                    </div>
                    <a href="/buy/claimcart/products/filter/<%= product.city %>/<%= product.tehsil %>" class="link">Click here to get to the full product details in your claim cart</a>
                  </div>
                <% }) %>
              <% } else { %>
                <div>No product info found.</div>
              <% } %>
              <strong>Message:</strong> <%= claimedMsg.message %>
            </div>
            <div class="date">
              <strong>Date:</strong> <%= claimedMsg.date.toLocaleString() %>
            </div>

          </div>
        <% }) %>
      <% } else { %>
        <div class="post-card">
          No claimed product messages yet.
        </div>
      <% } %>
    </div>

  </div>

  <footer>

    <div class="aboutThisPage">
      <div class="aboutThisPageLanguage">
        <div class="languageImage">
          üåê
        </div>
        <div class="languageText">
           English
        </div>  
      </div>

      <div class="aboutCountry">
        <div class="aboutCountryImage">
          <img src="/imagesAndVideos/images/1f1ee-1f1f3.png" alt="">
        </div>
        <div class="aboutCountryText">
           India
        </div>
      </div>
    </div>

    <div class="aboutCompany">
      <div class="companyConditions aboutCompanyTexts">
        Conditions of Use
      </div>
      <div class="companyPrivacyPolicy aboutCompanyTexts">
        Privacy Notice
      </div>
      <div class="aboutAdvertising aboutCompanyTexts">
        Interest-Based Ads
      </div>
    </div>

    <div class="companyCopywrite">
      .c. 1996-2024, Landbook.com, Inc. and its affiliates
    </div>

  </footer>


  <script>
    
    let openSection = null;
    function toggleView(id) {
      const section = document.getElementById(id);

      if(openSection && openSection !== section) {
        openSection.style.maxHeight = 0;
        openSection.classList.remove('open');
      }

      if(section.classList.contains('open')) {
        section.style.maxHeight = 0;
        section.classList.remove('open');
        openSection = null;
      } else {
        section.classList.add('open');
        section.style.maxHeight = section.scrollHeight + 'px';
        openSection = section;
      }
    const dot = document.getElementById('claimedDot');
    if(dot) {
      dot.style.display = 'none'
    }
    }
    
  </script>



  <select id="languageSelect language-select" hidden>
    <option value="en">English</option>
    <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
    <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
    <option value="ur">ÿßÿ±ÿØŸà</option>
    <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
    <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
    <option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option>
    <option value="gu">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</option>
    <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</option>
    <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
    <option value="it">Italiano</option>
  </select>


  <script>
  (function() {
const SELECT_ID = 'languageSelect';
const STORAGE_KEY = 'preferredLanguage';
const defaultSourceLang = 'en';

function setCookie(name, value, days, path = '/') {
  const d = new Date();
  d.setTime(d.getTime() + (days*24*60*60*1000));
  document.cookie = `${name}=${value};expires=${d.toUTCString()};path=${path}`;
}

function getCookie(name) {
  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  return match ? decodeURIComponent(match[2]) : null;
}

// Extract target language from googtrans cookie ("/en/hi" ‚Üí "hi")
function currentLangFromCookie() {
  const c = getCookie('googtrans');
  if (!c) return defaultSourceLang;
  const parts = c.split('/');
  return parts[2] || defaultSourceLang;
}

function trySetComboLang(lang) {
  const combo = document.querySelector('.goog-te-combo');
  if (combo) {
    if (combo.value !== lang) {
      combo.value = lang;
      combo.dispatchEvent(new Event('change'));
      console.log('Translate combo switched ‚Üí', lang);
    } else {
      console.log('Language already active ‚Üí', lang);
    }
    return true;
  }
  return false;
}

function fallbackSetLang(lang) {
  try {
    setCookie('googtrans', `/${defaultSourceLang}/${lang}`, 365, '/');
    setCookie('googtrans', `/${defaultSourceLang}/${lang}`, 365, '/');
    window.location.reload();
  } catch (e) {
    console.error('fallbackSetLang error', e);
  }
}

function setLanguage(lang) {
  localStorage.setItem(STORAGE_KEY, lang);

  // prevent loop if already same language
  const current = currentLangFromCookie();
  if (current === lang) {
    console.log('Skip re-translate (already', lang, ')');
    return;
  }

  let attempts = 0;
  const maxAttempts = 25;
  const interval = setInterval(() => {
    attempts++;
    const done = trySetComboLang(lang);
    if (done) {
      clearInterval(interval);
      return;
    }
    if (attempts >= maxAttempts) {
      clearInterval(interval);
      console.warn('Combo not found, fallback to cookie');
      fallbackSetLang(lang);
    }
  }, 100);
}

function initSelector() {
  const sel = document.getElementById(SELECT_ID);
  if (!sel) return;

  // restore saved
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) {
    sel.value = saved;
    const current = currentLangFromCookie();
    if (current !== saved) {
      setLanguage(saved);
    }
  }

  sel.addEventListener('change', function() {
    const lang = this.value;
    setLanguage(lang);
  });
}

if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initSelector);
} else {
  initSelector();
}
})()

  </script>


</body>
</html>