<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Landbooker real product creation panel</title>

  <link rel="stylesheet" href="/stylesheets/homePagesCSS/landbooker-create-products.css">

</head>
<body>

  <div class="header">
    <div class="title">
      Landbook
    </div>
    <div class="aboutPage">
      Landbooker panel
    </div>
  </div>

  <!-- navigations -->
  <nav class="main-navbar">
    <button class="hamburger" onclick="toggleSidebar()">
      &#9776
    </button>
    <div class="hamburgerNotification">
      <%= skymanProducts.length + mapProductCreationLength %>
    </div>
  </nav>

  <div id="sidebar" class="sidebar">
    <div class="sidebarTops">
      <button class="close-btn" onclick="toggleSidebar()">
        &times;
      </button>
    </div>
    <div class="navigationsBox">
      <a href="/us/landbook" class="links">
        <div class="navLinks">
          Home
        </div>       
      </a>

      <a href="/us/skyman-products-page" class="links">
        <div class="navLinks skymanProducts">
          Skyman products page
        </div>
        <div class="skymanProductsNotification">
          <%= skymanProducts.length %>
        </div>
      </a>
    </div>
    <div class="navigationsBox4">
      <a href="/home/compress/landbooker/skyman" class="links">
        <div class="navLinks">
          Khatauni images compressing page
        </div>
      </a>
      <a href="/us/admin-calculator" class="links">
        <div class="navLinks">
          Calculator
        </div>
      </a>
    </div>
    <div class="navigationsBox5">
      <a href="/us/adminProducts" class="links">
        <div class="navLinks createMapElements">
          Create new map elements
        </div>       
      </a>
      <div class="createMapElementsNotification">
        <%= mapProductCreationLength %>
      </div>
      <a href="/home/aboutus" class="links">
        <div class="navLinks sellingForms">
          About us
        </div>
      </a>
    </div>
    <!-- <div class="navigationsBox2">
      <a href="/us/landbookers-buying-cart-timers" class="links">
        <div class="navLinks buyingCartTimer">
          Buying cart timers
        </div>       
      </a>
      <div class="buyingCartTimerNotification">
        
      </div>
      <a href="/us/landbooker-user-bayana-forms" class="links">
        <div class="navLinks userBayanaForms">
          Users bayana forms
        </div>
      </a>
      <div class="userBayanaFormsNotification">
        
      </div>
    </div>
    <div class="navigationsBox3">
      <a href="/us/admin-calculator" class="links">
        <div class="navLinks">
          Landbook price calculator
        </div>
      </a>
    </div> -->
  </div>

  <!-- sidebar container -->
  <!-- <div class="sidebarContainer">
    <a href="/us/buyingforms" class="sidebarLinks">
      <div class="buyingForms sidebarContents">
        <img src="/imagesAndVideos/Logos/LOGO/Wow4.webp" alt="">
        Buying forms
      </div>
      <div class="buyingFormsNotification">
        
      </div>
    </a>
    <a href="/us/Sellingforms" class="sidebarLinks">
      <div class="sellingForms sidebarContents">
        <img src="/imagesAndVideos/Logos/Cart Icon.svg" alt="">
        SellingForms
      </div>
      <div class="sellingFormsNotification">
        
      </div>
    </a>  
    <a href="/us/newMapProductcreation" class="sidebarLinks">
      <div class="createMapElements sidebarContents">
        <img src="/imagesAndVideos/Logos/Help icon.svg" alt="">
        Create new map elements
      </div>
      <div class="createMapElementsNotification">
        <%= mapProductCreationLength %>
      </div>
    </a>

    <a href="/us/mapCoordinates" class="sidebarLinks">
      <div class="supportUsIcon sidebarContents">
        <img src="/imagesAndVideos/Logos/User feedback icon.svg" alt="">
        Get map coordinates
      </div>
    </a>

    <a href="/home/aboutus" class="sidebarLinks">
      <div class="aboutUsIcon sidebarContents">
        <img src="/imagesAndVideos/Logos/About us icon.svg" alt="">
        About Us
      </div>
    </a>

  </div> -->

  <% if(success.length > 0) { %>
    <div class="flash flash-success">
      <%= success %>
    </div>
  <% } %>
  <% if(error.length > 0) { %>
    <div class="flash flash-error">
      <%= error %>
    </div>
  <% } %>

  <div class="container">
    <div class="pageTitle">
      Create Real Product
    </div>
    <div class="productDetails">
      <div class="productDetailTitle">
        Create Real product
      </div>
      <form action="/landad/admin/c&p.cp" method="post" enctype="multipart/form-data">

        <input type="text" name="title" class="inputs" placeholder="Enter title of zameen" required>

        <input type="text" name="city" class="inputs" placeholder="Enter city of zameen" required>

        <input type="text" name="tehsil" class="inputs" placeholder="Enter tehsil of zameen" value="<%= skymanProduct.tehsil %>" readonly required><hr>

        <label class="labels" class="labels">Product side images (<span class="highlights">5</span>) [1. <span class="highlights">Real image</span> 2. <span class="highlights">L*B image</span> 3. <span class="highlights"> Road and land height compare image</span> 4. <span class="highlights">Upto main road width of front road image</span> 5. <span class="highlights">Badnaam image</span> ]: </label>
        <input type="file" multiple accept="image/*" name="productImages" class="file inputs" required><hr>

        <label class="labels">360 degree image (<span class="highlights">1</span>): </label>
        <input type="file" accept="image/*" name="product360Image" class="file inputs" required><hr>

        <label class="labels">Badnaam image(<span class="highlights">1</span>): </label>
        <input type="file" accept="image/*" name="badnaamImage" class="file inputs" required><hr>

        <label class="labels">Rating image: </label>
        <input type="file" accept="image/*" name="ratingImage" class="file inputs" placeholder="Enter the rating of this zameen" required><hr>

        <input type="number" name="ratingCount" class="inputs" placeholder="Enter rating count of product" step="any" required>

        <label for="khatauniFile" class="labels">Compressed Khatauni File (.zip or .pdf):</label>
        <input type="file" name="compressedKhatauniFile" id="khatauniFile" class="file inputs" accept=".zip,.pdf" required>

        <label for="youtubeLink" class="labels">Enter youtube video link of product</label>
        <div class="input-with-button">
          <input type="url" id="youtubeLink" name="youtubeLink" placeholder="https://www.youtube.com/watch?v=xyz123" autocomplete="off" class="inputs" required>
          <button type="button" id="pasteButton" title="Paste from clipboard">ðŸ“‹</button>
          <p id="linkMessage" class="link-message"></p>
        </div>

        <!-- prices starts-->
        <input type="number" id="sellerPrice" name="sellerPrice" class="inputs" placeholder="Enter original price" value="<%= skymanProduct.sellerPrice.toFixed(2) %>" readonly step="any" required>

        <input type="number" id="landbookPrice" name="landbookPrice" class="inputs" placeholder="Enter landbook price" step="any" required readonly>

        <input type="number" id="brokerPrice" name="brokerPrice" class="inputs" placeholder="Enter broker price" step="any" required readonly>
        <!-- prices ends -->

        <input type="text" name="LB" class="inputs" value="<%= skymanProduct.LB %>" placeholder="Enter LB" readonly required>

        <!-- <input type="number" name="area" class="inputs" placeholder="Enter area in sqft." required> -->
        <label for="" class="labels">Address of land: </label>
        <input type="text" name="landAddress" class="inputs" placeholder="Enter Address of zameen" value="<%= skymanProduct.landAddress %>" required>

        <label class="labels" for="spec">Specifications (one per line): </label>
        <textarea class="fixed-textarea" name="spec" rows="5" cols="30" placeholder="Enter spec of this zameen" style="width: 100%;margin-bottom: 12px;"><%- skymanProduct.spec.join('\n') %></textarea>

        <label class="labels" for="why">Why to buy (one per line): </label>
        <textarea class="fixed-textarea" name="why" rows="5" cols="30" placeholder="Enter why details of this zameen" style="width: 100%;margin-bottom: 12px;"></textarea>

        <input type="text" name="sellerId" class="inputs" value="<%= skymanProduct.sellerId %>" readonly required>

        <input type="text" name="sellingFormId" class="inputs" value="<%= skymanProduct.sellingFormId %>" readonly required>

        <label class="labels">Skyman product id: </label>
        <input type="text" name="skymanProductId" class="inputs" value="<%= skymanProduct._id %>" readonly required>

        <input type="number" step="any" name="lat" class="inputs" value="<%= skymanProduct.lat %>" readonly required>

        <input type="number" step="any" name="lng" class="inputs" value="<%= skymanProduct.lng %>" readonly required>

        <input type="number" name="sellerContact" hidden value="<%= skymanProduct.contactNumber %>">

        <input type="text" name="keys" class="inputs" placeholder="Enter keys of product" required>

        <input type="text" name="recommendation" class="inputs" placeholder="Enter location keys of product" required>

        <input type="submit" value="Create product" class="inputs submit-button">
      </form>
    </div>

    <div class="">
      <a href="/us/adminProducts" class="readProducts">
        Read all products.
      </a>
    </div>

  </div>


  <script>
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('active');
    }
    // for input type youtube url link
    document.getElementById("pasteButton").addEventListener("click", async () => {
      const input = document.getElementById("youtubeLink");
      const message = document.getElementById("linkMessage");

      try {
        const text = await navigator.clipboard.readText();

        if (!text) {
          message.textContent = "âš ï¸ Clipboard is empty â€” copy a YouTube link first!";
          message.style.color = "orange";
          return;
        }

        input.value = text.trim();

        // âœ… YouTube URL validation (works for normal & short links)
        const youtubePattern =/^(?:https?:\/\/)?(?:www\.|m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/|shorts\/)?([a-zA-Z0-9_-]{11})(?:[?&].*)?$/;

        if (youtubePattern.test(text.trim())) {
          message.textContent = "âœ… Valid YouTube link detected!";
          message.style.color = "green";
          input.style.borderColor = "#28a745";
        } else {
          message.textContent = "âŒ Not a valid YouTube link. Please check the URL.";
          message.style.color = "red";
          input.style.borderColor = "#dc3545";
        }

      } catch (err) {
        message.textContent = "âŒ Clipboard access denied. Paste manually (Ctrl+V).";
        message.style.color = "red";
        console.error(err);
      }
    });

    window.addEventListener('DOMContentLoaded', () => {
      const sellerPrice = document.getElementById('sellerPrice');
      const landbookPrice = document.getElementById('landbookPrice');
      const brokerPrice = document.getElementById('brokerPrice');

      const sPrice = parseFloat(sellerPrice.value);

      const likhFemale = sPrice * 0.07;
      const ourCost = sPrice * 0.023;
      const brokerCost = sPrice * 0.038;
      const brokerFinalFemale = sPrice + likhFemale + brokerCost;
      const finalFemale = sPrice + likhFemale + ourCost;

      landbookPrice.value = finalFemale.toFixed(2);
      brokerPrice.value = brokerFinalFemale.toFixed(2);
    })

  </script>

</body>
</html>